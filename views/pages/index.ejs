<!DOCTYPE html>

<html>
<head>
    <% include ../partials/header.ejs %>
    <title>Toolbone Webtor</title>
    <meta charset="UTF-8">

    <style id="compiled-css" type="text/css">
        body {
            margin: 0;
            padding: 0;
            background-color: #000000;
        }
        #player {
            position: relative;
            top: 50%;
            transform: translateY(-50%);
        }

    </style>
</head>

<body>
    <div style="text-align:center; width:100%; position: fixed; top: 0; left: 0; bottom: 0; right: 0; ">
        <p id="total"></p>
        <video id="player" controls></video>
    </div>
</body>

<script type="text/javascript">

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);

    const hash = urlParams.get('hash')
    const magnets = "%26tr%3Dudp%3A%2F%2Fexplodie.org%3A6969%26tr%3Dudp%3A%2F%2Ftracker.coppersurfer.tk%3A6969%26tr%3Dudp%3A%2F%2Ftracker.empire-js.us%3A1337%26tr%3Dudp%3A%2F%2Ftracker.leechers-paradise.org%3A6969%26tr%3Dudp%3A%2F%2Ftracker.opentrackr.org%3A1337%26tr%3Dwss%3A%2F%2Ftracker.btorrent.xyz%26tr%3Dwss%3A%2F%2Ftracker.fastcast.nz%26tr%3Dwss%3A%2F%2Ftracker.openwebtorrent.com%26ws%3Dhttps%3A%2F%2Fwebtorrent.io%2Ftorrents%2F%26xs%3Dhttps%3A%2F%2Fwebtorrent.io%2Ftorrents%26tr%3Dudp%3A%2F%2Fopen.demonii.com%3A1337%2Fannounce%26tr%3Dudp%3A%2F%2Ftracker.openbittorrent.com%3A80%26tr%3Dudp%3A%2F%2Ftracker.coppersurfer.tk%3A6969%26tr%3Dudp%3A%2F%2Fglotorrents.pw%3A6969%2Fannounce%26tr%3Dudp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce%26tr%3Dudp%3A%2F%2Ftorrent.gresille.org%3A80%2Fannounce%26tr%3Dudp%3A%2F%2Fp4p.arenabg.com%3A1337%26tr%3Dudp%3A%2F%2Ftracker.leechers-paradise.org%3A6969";


    let client = new WebTorrent();
    //var torrentId = 'magnet:?xt=urn:btih:08ada5a7a6183aae1e09d831df6748d566095a10&dn=Sintel&tr=udp%3A%2F%2Fexplodie.org%3A6969&tr=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969&tr=udp%3A%2F%2Ftracker.empire-js.us%3A1337&tr=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337&tr=wss%3A%2F%2Ftracker.btorrent.xyz&tr=wss%3A%2F%2Ftracker.fastcast.nz&tr=wss%3A%2F%2Ftracker.openwebtorrent.com&ws=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2F&xs=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2Fsintel.torrent';
    //var torrentId = 'magnet:?xt=urn:btih:9EFF2A521DD4F44B057A0C0A550C90A8243D3F17&dn=Sintel&tr=udp%3A%2F%2Fexplodie.org%3A6969&tr=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969&tr=udp%3A%2F%2Ftracker.empire-js.us%3A1337&tr=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337&tr=wss%3A%2F%2Ftracker.btorrent.xyz&tr=wss%3A%2F%2Ftracker.fastcast.nz&tr=wss%3A%2F%2Ftracker.openwebtorrent.com&ws=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2F&xs=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2Fsintel.torrent';
    //var torrentId = 'magnet:?xt=urn:btih:9EFF2A521DD4F44B057A0C0A550C90A8243D3F17&tr=udp://glotorrents.pw:6969/announce&tr=udp://tracker.opentrackr.org:1337/announce&tr=udp://torrent.gresille.org:80/announce&tr=udp://tracker.openbittorrent.com:80&tr=udp://tracker.coppersurfer.tk:6969&tr=udp://tracker.leechers-paradise.org:6969&tr=udp://p4p.arenabg.ch:1337&tr=udp://tracker.internetwarriors.net:1337&tr=wss://tracker.openwebtorrent.com&tr=wss%3A%2F%2Ftracker.btorrent.xyz&tr=wss%3A%2F%2Ftracker.fastcast.nz&tr=wss%3A%2F%2Ftracker.openwebtorrent.com&tr=wss%3A%2F%2Ftracker.webtorrent.io&ws=https%3A%2F%2Fwebtorrent.io';
    let torrentId = "magnet:?xt=urn:btih:"+hash+magnets;

    const player = new Plyr('#player', {
        debug: true
    });


    client.add(torrentId, function (torrent) {
        let file = torrent.files.find(function (file) {
            return file.name.endsWith('.mp4')
        });
        file.renderTo('video', {
            autoplay: false,
            muted: true
        }, function callback() {
            console.log("ready to play!");
        });
    });
</script>

</html>
